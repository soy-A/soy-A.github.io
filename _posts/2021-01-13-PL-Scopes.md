---
layout: post
title: "[프로그래밍 언어론] 영역(scope)"
author: "Soy-A"
comments: true
tags:
- Programming Language
---

# 영역(scope)

- **변수의 영역**: 그 변수가 **가시적(visible)**인 문장들의 범위
- 변수가 어떤 문장에서 **참조**될 수 있으면, 변수는 그 문장에서 **가시적**이다
- **지역 변수**(local variable): 프로그램 단위나 블록 **내부에 정의**된 변수
- **비지역 변수**(nonlocal variable): 그 프로그램 단위나 블록 **내부에서 가시적**이나 그곳에 **선언되어 있지 않은** 변수
> global 변수는 비지역 변수의 특정 카테고리임
- 언어의 영역 규칙은 어떤 이름의 특정 참조가 변수와 어떻게 연관되는지를 결정

---

## 정적 영역(static scope)

- 프로그램 텍스트에 기반함
> **실행 전, 텍스트만 보고도 영역 알 수 있다**
- 변수의 영역이 정적으로, 실행 전에 결정될 수 있다

### 탐색 과정

- 주어진 이름에 대해 검색될 때까지 **로컬에서 먼저 검색**한 다음 **점점 더 큰 영역**을 포함하는 영역 내에서 검색 선언한다
- **정적 조상(static ancestor)**: 특정 영역에 포함되는 정적 영역
- 가장 가까운 정적 조상을 정적 부모라 부른다
> ```
function big() {	// sub2의 부모
	function sub1() {
		var x = 7;
		sub2();
	}
	function sub2() {
		var y = x;	// x의 선언이 영역 내에 없다 -> 부모 확인
	}
	var x = 3;		// 선언 발견
	sub1();
}
```
sub2에서 x에 대한 선언이 발견되지 않는다. 따라서 **부모인 big**를 확인, 선언되어있으면 그 값을 가져온다.

---

## 블록(blocks)

- 새로운 **정적 영역**이 실행 코드의 **중간에 정의**되는 방법
- 언어마다 블록이 어떻게 영향을 끼치는지는 다 다름
> C, C++은 블록이 새 영역을 만들 수 있다. <br/>
but **Java는 안됨**(블록을 만들어도 새로운 정적 영역을 만들지는 못한다)
> ```
void sub() {
	int count;
	...
	while(...) {	// 새로운 scope 생성됨
		int count;
		count++;
		...
	}
	...
}
```

- 변수들은 "closer"변수를 가짐으로써 같은 이름을 가진 프로그램 유닛으로부터 숨겨질 수 있다
- C++, Ada는 "hidden"변수에 접근이 허용된다
> Ada: unit.name<br/>
C++: class_name :: name<br/>
C: extern int x<br/>
python: global x

---

## 동적 영역(dynamic scope)

- 동적 영역은 부프로그램들의 공간적 배치 관계가 아닌, 부프로그램들의 **호출 시퀀스에 기반**한다

### 탐색 과정

- **로컬에서 먼저 검색**한 다음 이 지점까지 실행된 **하위 프로그램 호출의 연결**을 통해 다시 검색한다
> ```
function big() {
	function sub1() {	// 이번엔 sub1이 sub2의 부모이다(호출하므로)
		var x = 7;
		sub2();
	}
	function sub2() {
		var y = x;	// x의 선언이 영역 내에 없다 -> 부모 확인
	}
	var x = 3;
	sub1();
}
```
>- big: x = 3<br/>
>- sub1: x = 7<br/>
>- sub2: x = 7

---

#### 정적 영역
- 장점: readability, reliability
> 과정 보지 않고 코드만 봐도 변수 파악 가능하다
- 단점: 변수와 부프로그램에 필요보다 더 많은 접근을 허용한다
> 부모가 많을 때, 어떤 부프로그램의 변수 x는 모든 부모의 x에 접근할 수 있다 -> 엉뚱한 값에 접근하게 될 위험이 있다

#### 동적 영역
- 장점: 편의성
> 파라미터 파싱이 필요하지 않다
- 단점: readabiliity 떨어짐, 신뢰성 떨어짐
> 타입 검사가 잘 이루어지지 않는다

---

## 영역(scope)과 존속기간(lifetime)

- 영역: 접근할 수 있는 유효범위
- 존속기간: 언제 할당, 언제 회수
- 영역과 존속기간은 때때로 관련되어있는 것 처럼 보이나, 이 둘은 다른 개념이다
> C, C++에서 static을 이용하여 함수에 선언된 변수<br/>
>- 함수의 영역, 기억공간에 정적으로 바인딩됨<br/>
>- but 변수의 존속기간은 함수가 속한 프로그램의 전체 실행 시간에 걸쳐 확장됨
- 영역과 존속기간은 부프로그램 호출이 고려될 때에는 관련이 없다

---

## 참조 환경(referencing environments)

to be continued

<br/><br/><br/>
**참고 문헌**<br/>
Concepts of Programming Languages, Robert W. Sebesta -10th ed.